<navbar id="navbar"></navbar>
<script>$("#navbar").load(`/views/imports/navbar.html`, function(response, status, xhr) { })</script>
<div class="bodyConsultas left17" style="position: relative; top: 10vh; left: 4.5vw">
  <div id="changeTop" class="background-Propostas left16-5 width70 scroll2 top10" style="position: absolute; left: 25vw; top: 19vh; width: 50vw; border-radius: 3vh;">
    <div class="max-height50" style="max-height: 70vh; overflow-y: auto; margin-block: 2vh;">
      <div id="novaConsulta">
        <div class="font-size2" style="width: 100%; display: flex; justify-content: center; font-size: 4vh; margin-top: 3vh">    
          <a>Consultas de FGTS:</a>
        </div>
        <div style="width: 100%; display: flex; justify-content: center; margin-top: 2vh">
          <fieldset class="font-size2" title="Selecione o Banco..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 40vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; ">
            <legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Banco</legend>
            <select id="banks" onchange="setBank(this.value)" class="font-1 font-color" style="cursor: pointer; font-size: 2.3vh; width: 40vw; background: transparent; border:none; border: 0; font-weight: 400;">
              <option value="false" style="color: black;" selected>Não Selecionado</option>
              <option value="FACTA FINANCEIRA" style="color: black; font-weight: 600;">Facta Financeira</option>
              <option value="BANCO C6" style="color: black; font-weight: 600;">Banco C6</option>
              <option value="PANAMERICANO" style="color: black; font-weight: 600">Panamericano</option>
              <option value="SAFRA" style="color: black; font-weight: 600;">Safra</option>
              <option value="MERCANTIL" style="color: black; font-weight: 600;">Mercantil</option>
              <option value="BMG" style="color: black; font-weight: 600;" >BMG</option>
            </select>
          </fieldset>
        </div>
        <div style="width: 100%; display: flex; justify-content: center; margin-top: 2vh">
          <fieldset class="font-size2" title="Coloque o CPF..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 30vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; ">
            <legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">CPF</legend>
            <input id="cpf" class="font-1 font-color" placeholder="000.000.000-00" style="width: 30vw; height: 3vh; margin: 0; font-size: 2.3vh; background: transparent; border: 0">
          </fieldset>
        </div>
        <div id="options" style="width: 100%; display: flex; justify-content: center; margin-top: 2vh">
        
        </div>
        <div id="options2" style="width: 100%; display: flex; justify-content: center; margin-top: 2vh">

        </div>
        <div style="width: 100%; display: flex; justify-content: center; margin-top: 4vh;font-weight: 600;">
          <a id="consultar" onclick="consultar()" class="buttonLogin font-2 font-size1-5" style="font-size: 3vh; padding-inline: 3vh; padding-block: 1vh; border-radius: 1vh; margin-right: 1vw;">Consultar</a>
        </div>
        <div id="filaShow" style="width: 100%; display: flex; justify-content: center; font-weight: 600; margin-top: 1vh; margin-left: -0.5vw"></div>
      </div>
      <div id="resultConsulta" style="display: none">
        <div class="font-size2" style="width: 100%; display: flex; justify-content: center; font-size: 4vh; margin-top: 2vh">    
          <a>Resultado do Saldo FGTS:</a>
        </div>
        <div style="width: 100%; display: flex; justify-content: center; margin-top: 2vh">
          <fieldset class="font-size2" title="Coloque o CPF..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 30vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; ">
            <legend class="font-4 font-size2" style="margin: 0; padding: 0; font-size: 2.3vh">CPF</legend>
            <input id="cpfResult" class="font-1 font-color" placeholder="000.000.000-00" style="width: 30vw; height: 3vh; margin: 0; font-size: 2.3vh; background: transparent; border: 0" disabled>
          </fieldset>
        </div>
        <div style="width: 100%; display: flex; justify-content: center; margin-top: 2vh">
          <fieldset class="font-size2" style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; ">
            <legend id="liberadoName" class="font-4 font-size2" style="font-weight: 800; margin: 0; padding: 0; font-size: 2.3vh">Saldo Liberado</legend>
            <input id="liberadoResult" class="font-1 font-color" placeholder="000.00" style="width: 20vw; height: 3vh; margin: 0; font-size: 2.3vh; background: transparent; border: 0" disabled>
          </fieldset>
          <fieldset class="font-size2" style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; ">
            <legend id="totalName" class="font-4 font-size2" style="margin: 0; padding: 0; font-size: 2.3vh">Saldo Total</legend>
            <input id="totalResult" class="font-1 font-color" placeholder="000.00" style="width: 20vw; height: 3vh; margin: 0; font-size: 2.3vh; background: transparent; border: 0" disabled>
          </fieldset>
        </div>
        <div style="width: 100%; display: flex; justify-content: center; margin-top: 2vh">
          <fieldset class="font-size2" style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; ">
            <legend id="dataName" class="font-4 font-size2" style="margin: 0; padding: 0; font-size: 2.3vh">Data da Solicitação</legend>
            <input id="dataResult" class="font-1 font-color" placeholder="00/00/0000" style="width: 20vw; height: 3vh; margin: 0; font-size: 2.3vh; background: transparent; border: 0" disabled>
          </fieldset>
          <fieldset class="font-size2" style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; ">
            <legend id="parcName" class="font-4 font-size2" style="margin: 0; padding: 0; font-size: 2.3vh">Parcelas Adiantadas</legend>
            <input id="parcResult" class="font-1 font-color" placeholder="00" style="width: 20vw; height: 3vh; margin: 0; font-size: 2.3vh; background: transparent; border: 0" disabled>
          </fieldset>
        </div>
        <div style="width: 100%; text-align: center; margin-top: 2vh">
          <a class="font-2" style="font-weight: 600; padding: 0; font-size: 2.3vh;">Parcelas:</a>
        </div>
        <div id="parcs" class="borderColor" style="min-height: 8vh; margin-block: 1vh; margin-inline: 10%; width: 80%; border-radius: 1.5vh">
          <div class="line-bottom" style="width: 100%; display: flex; justify-content: center; text-align: center; padding-block: 0.8vh; font-size: 2.5vh; align-items: center;">
            <input onclick="toggle(this)" type="checkbox" style="width: 10%; height: 2vh; margin: 0">
            <a style="width: 50%;">Data</a>
            <a style="width: 40%;">Valor</a>
          </div>
        </div>
        <div style="width: 100%; display: flex; justify-content: center; margin-block: 3vh; font-weight: 600;">
          <a id="consultar" onclick="openNewCpf()" class="buttonLogin font-2 font-size1-5" style="font-size: 3vh; padding-inline: 3vh; padding-block: 1vh; border-radius: 1vh; margin-right: 1vw;">Consultar novo CPF</a>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  function toggle(source) {
    checkboxes = document.getElementsByName('checks');
    for(var i=0, n=checkboxes.length;i<n;i++) {
      checkboxes[i].checked = source.checked;
    }
  }
</script>
<script>
  var banks = [
    { name:'FACTA FINANCEIRA', options:'<fieldset class="font-size2" title="Selecione a Tabela..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 35vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; "><legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Tabela</legend><select id="option1"  class="font-1 font-color" style="cursor: pointer; font-size: 2.3vh; width: 35vw; background: transparent; border:none; border: 0; font-weight: 400;"><option value="GOLD" style="color: black; font-weight: 600;">Gold</option><option value="NORMAL" style="color: black; font-weight: 600;">Normal</option></select></fieldset>' },
    { name:'BANCO C6', options:'<fieldset class="font-size2" title="Selecione o Tipo..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; "><legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Tipo</legend><select id="option1" class="font-1 font-color" style="cursor: pointer; font-size: 2.3vh; width: 20vw; background: transparent; border:none; border: 0; font-weight: 400;"><option value="POR_VALOR_TOTAL" style="color: black; font-weight: 600;">Valor Total</option><option value="POR_VALOR_SOLICITADO" style="color: black; font-weight: 600;">Valor Solicitado</option><option value="POR_QUANTIDADE_DE_PARCELAS" style="color: black; font-weight: 600;">Quantidade de Parcelas</option></select></fieldset><fieldset class="font-size2" title="Coloque o Valor..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; "><legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Valor</legend><input id="option2" class="font-1 font-color" type="number" placeholder="000.00" style="width: 20vw; height: 3vh; margin: 0; font-size: 2.3vh; background: transparent; border: 0"></fieldset>' },
    { name:'PANAMERICANO', options:'<fieldset class="font-size2" title="Selecione o Tipo..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; "><legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Tipo</legend><select id="option1" class="font-1 font-color" style="cursor: pointer; font-size: 2.3vh; width: 20vw; background: transparent; border:none; border: 0; font-weight: 400;"><option value="POR_VALOR_TOTAL" style="color: black; font-weight: 600;">Valor Total</option><option value="POR_VALOR_SOLICITADO" style="color: black; font-weight: 600;">Valor Solicitado</option></select></fieldset><fieldset class="font-size2" title="Coloque o Valor..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; "><legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Valor</legend><input id="option2" class="font-1 font-color" placeholder="000.00" style="width: 20vw; height: 3vh; margin: 0; font-size: 2.3vh; background: transparent; border: 0"></fieldset><br/>', options2: '<fieldset class="font-size2" title="Selecione a Tabela..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 35vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; "><legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Tabela</legend><select id="option3"  class="font-1 font-color" style="cursor: pointer; font-size: 2.3vh; width: 35vw; background: transparent; border:none; border: 0; font-weight: 400;"><option value="900001" style="color: black; font-weight: 600;">GTS_CORBAN</option><option value="900006" style="color: black; font-weight: 600;">FGTS_CORBAN_FLEX1</option><option value="900007" style="color: black; font-weight: 600;">FGTS_CORBAN_FLEX2</option></select></fieldset>' },
    { name:'SAFRA', options:'<fieldset class="font-size2" title="Seleciona as parcelas..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 35vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; "><legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Parcelas</legend><select id="option1" class="font-1 font-color" style="cursor: pointer; font-size: 2.3vh; width: 35vw; background: transparent; border:none; border: 0; font-weight: 400;"><option value="1" style="color: black; font-weight: 600;">1 / 7</option><option value="2" style="color: black; font-weight: 600;">6 / 7</option></select></fieldset>' },
    { name:'MERCANTIL', options:'<fieldset class="font-size2" title="Selecione o Tipo..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; "><legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Tipo</legend><select id="option1" class="font-1 font-color" style="cursor: pointer; font-size: 2.3vh; width: 20vw; background: transparent; border:none; border: 0; font-weight: 400;"><option value="POR_VALOR_TOTAL" style="color: black; font-weight: 600;">Valor Total</option><option value="POR_QUANTIDADE_DE_PARCELAS" style="color: black; font-weight: 600;">Quantidade de Parcelas</option></select></fieldset><fieldset class="font-size2" title="Coloque as Parcelas..." style="font-size: 2.4vh; border-radius: 0.6vh; width: 20vw; height: 7vh; padding: 0; padding-inline: 0.4vw; margin: 0; margin-left: 0.5vw; "><legend class="font-4" style="margin: 0; padding: 0; font-size: 2.3vh">Parcelas</legend><input id="option2" class="font-1 font-color" placeholder="00" style="width: 20vw; height: 3vh; margin: 0; font-size: 2.3vh; background: transparent; border: 0"></fieldset>' },
    { name:'BMG', options: false },
  ]
  function setBank(bank) {
    if (bank) {
      if (banks.findIndex(r=>r.name==bank) >= 0 && banks[banks.findIndex(r=>r.name==bank)].options) {
        document.getElementById('options').innerHTML = `${banks[banks.findIndex(r=>r.name==bank)].options}`
        if (banks.findIndex(r=>r.name==bank) >= 0 && banks[banks.findIndex(r=>r.name==bank)].options2) {
          document.getElementById('options2').innerHTML = `${banks[banks.findIndex(r=>r.name==bank)].options2}`
        } else document.getElementById('options2').innerHTML = ``
      } else document.getElementById('options').innerHTML = ``
    } else document.getElementById('options').innerHTML = ``
  }
  function consultar() {
    if (document.getElementById('consultar').classList.contains('buttonBlock')) return alert('Sua consulta já está na fila! Aguarde um pouco, por favor...')
    if (!document.getElementById('banks').value || document.getElementById('banks').value == 'false') return alert('Selecione o banco em que será feito a consulta!')
    if (!document.getElementById('cpf').value) return alert('Colque o CPF que será consultado!')
    document.getElementById('cpf').value = document.getElementById('cpf').value.replace(".","").replace(".","").replace("-","")
    if (document.getElementById('cpf').value.length != 11) return alert('O CPF está invalido, verifique e tente novamente...')
    document.getElementById('consultar').classList.add("buttonBlock");
    setTimeout(function(){ verifyQueue(0) }, 500)
    $.ajax({ type: "post",url: `https://api.concredito.com.br/consultas/fgts`,
      data: JSON.stringify({
        user: localStorage.getItem('user'),
        password: localStorage.getItem('password'),
        cpf: document.getElementById('cpf').value,
        bank: document.getElementById('banks') && document.getElementById('banks').value != 'false' ? document.getElementById('banks').value : false,
        option1: document.getElementById('option1') ? document.getElementById('option1').value : false,
        option2: document.getElementById('option2') ? document.getElementById('option2').value : false,
        option3: document.getElementById('option3') ? document.getElementById('option3').value : false,
      }), contentType:"application/json; charset=utf-8",
      success: async function(s) {
        if (s.error) {
          document.getElementById('consultar').classList.remove("buttonBlock");
          return alert(s.error)
        }
        document.getElementById('cpfResult').value = s.cpf
        document.getElementById('totalResult').value = s.saldoTotal
        document.getElementById('liberadoResult').value = s.saldoLiberado
        document.getElementById('dataResult').value = s.data
        document.getElementById('parcResult').value = s.parcelas.length
        document.getElementById('parcs').innerHTML = `<div class="line-bottom" style="width: 100%; display: flex; justify-content: center; text-align: center; padding-block: 0.8vh; font-size: 2.5vh; align-items: center;"><input onclick="toggle(this)" type="checkbox" style="width: 10%; height: 2vh; margin: 0"><a style="width: 50%;">Data</a><a style="width: 40%;">Valor</a></div>`
        s.parcelas.forEach((element)=>{
          document.getElementById('parcs').innerHTML += `<div class="line-top" style="width: 100%; display: flex; justify-content: center; text-align: center; padding-block: 0.8vh; font-size: 2.5vh; align-items: center;"><input name="checks" type="checkbox" style="width: 10%; height: 2vh; margin: 0"><a class="font-size2" style="width: 50%;">${element.data}</a><a class="font-size2" style="width: 40%;">${element.valor}</a></div>`
        })
        document.getElementById('novaConsulta').style.display = 'none'
        document.getElementById('resultConsulta').style.display = 'inline'
        document.getElementById('consultar').classList.remove("buttonBlock");
        document.getElementById('changeTop').style.top = '8vh'
        if (screen.width <= 900) {
          document.getElementById('cpfResult').value = s.cpf
          document.getElementById('totalName').innerHTML = "Total"
          document.getElementById('liberadoName').innerHTML = "Liberado"
          document.getElementById('dataName').innerHTML = "Data"
          document.getElementById('parcName').innerHTML = "Parcelas"
        }
      },
      error: function(e) {
        document.getElementById('consultar').classList.remove("buttonBlock");
        if (e && e.responseJSON && e.responseJSON.error) return alert(e.responseJSON.error)
        return alert(`Ocorreu algum erro indefinido! Tente novamente mais tarde...`)
      }
    })
  }
  function verifyQueue(fila) {
    $.ajax({ type: "post",url: `https://api.concredito.com.br/consultas/queue`,
      data: JSON.stringify({
        user: localStorage.getItem('user'),
        password: localStorage.getItem('password'),
        fila: fila,
        bank: document.getElementById('banks') && document.getElementById('banks').value != 'false' ? document.getElementById('banks').value : false,
      }), contentType:"application/json; charset=utf-8",
      success: async function(s) {
        if (s.fila) {
          document.getElementById('filaShow').innerHTML = `<a id="fila" style="font-size: 2vh; font-weight: 400">Sua posição na fila: ${s.fila}</a>`
          verifyQueue(s.fila)
        } else document.getElementById('filaShow').innerHTML = ``
      },
      error: function(e) {
        if (e && e.responseJSON && e.responseJSON.error) return alert(e.responseJSON.error)
        return alert(`Ocorreu algum erro indefinido! Tente novamente mais tarde...`)
      }
    })
  }
  function openNewCpf() {
    document.getElementById('changeTop').style.top = '19vh'
    document.getElementById('novaConsulta').style.display = 'inline'
    document.getElementById('resultConsulta').style.display = 'none'
  }
  (function () {
    
  })();
</script>